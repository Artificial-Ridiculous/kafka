[2019-06-05 23:16:50,518] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)), 1 -> Map(my-replicated-topic-0 -> Vector(1, 0, 2)), 0 -> Map(__consumer_offsets-21 -> Vector(0), __consumer_offsets-27 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-9 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-35 -> Vector(0), __consumer_offsets-41 -> Vector(0), __consumer_offsets-33 -> Vector(0), __consumer_offsets-23 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-47 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-3 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-15 -> Vector(0), __consumer_offsets-17 -> Vector(0), __consumer_offsets-19 -> Vector(0), __consumer_offsets-11 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-39 -> Vector(0), __consumer_offsets-45 -> Vector(0), __consumer_offsets-1 -> Vector(0), __consumer_offsets-5 -> Vector(0), __consumer_offsets-29 -> Vector(0))) (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2019-06-05 23:16:50,519] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:21:52,931] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-06-05 23:21:52,932] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)), 1 -> Map(my-replicated-topic-0 -> Vector(1, 0, 2)), 0 -> Map(__consumer_offsets-21 -> Vector(0), __consumer_offsets-27 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-9 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-35 -> Vector(0), __consumer_offsets-41 -> Vector(0), __consumer_offsets-33 -> Vector(0), __consumer_offsets-23 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-47 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-3 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-15 -> Vector(0), __consumer_offsets-17 -> Vector(0), __consumer_offsets-19 -> Vector(0), __consumer_offsets-11 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-39 -> Vector(0), __consumer_offsets-45 -> Vector(0), __consumer_offsets-1 -> Vector(0), __consumer_offsets-5 -> Vector(0), __consumer_offsets-29 -> Vector(0))) (kafka.controller.KafkaController)
[2019-06-05 23:21:52,932] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-06-05 23:21:52,933] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:21:52,933] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-06-05 23:21:52,933] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:21:52,933] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2019-06-05 23:21:52,933] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:26:52,933] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-06-05 23:26:52,934] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)), 1 -> Map(my-replicated-topic-0 -> Vector(1, 0, 2)), 0 -> Map(__consumer_offsets-21 -> Vector(0), __consumer_offsets-27 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-9 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-35 -> Vector(0), __consumer_offsets-41 -> Vector(0), __consumer_offsets-33 -> Vector(0), __consumer_offsets-23 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-47 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-3 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-15 -> Vector(0), __consumer_offsets-17 -> Vector(0), __consumer_offsets-19 -> Vector(0), __consumer_offsets-11 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-39 -> Vector(0), __consumer_offsets-45 -> Vector(0), __consumer_offsets-1 -> Vector(0), __consumer_offsets-5 -> Vector(0), __consumer_offsets-29 -> Vector(0))) (kafka.controller.KafkaController)
[2019-06-05 23:26:52,935] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-06-05 23:26:52,935] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:26:52,935] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-06-05 23:26:52,935] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:26:52,935] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2019-06-05 23:26:52,935] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:28:40,029] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2019-06-05 23:28:40,030] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2019-06-05 23:28:40,031] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2019-06-05 23:28:40,038] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:28:40,038] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=my-replicated-topic,Partition=0,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:28:40,075] INFO [RequestSendThread controllerId=0] Controller 0 connected to ubuntu:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-06-05 23:28:40,162] INFO [RequestSendThread controllerId=0] Controller 0 connected to ubuntu:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-06-05 23:28:40,162] INFO [RequestSendThread controllerId=0] Controller 0 connected to ubuntu:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-06-05 23:28:40,162] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:28:40,162] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=my-replicated-topic,Partition=0,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:28:40,165] TRACE [Controller id=0] All leaders = __consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),my-replicated-topic-0 -> (Leader:1,ISR:0,1,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),connect-test-0 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:2,ISR:2,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2019-06-05 23:28:41,410] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, all live brokers: 0,1 (kafka.controller.KafkaController)
[2019-06-05 23:28:41,410] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2019-06-05 23:28:41,410] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2019-06-05 23:28:41,411] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2019-06-05 23:28:41,419] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2019-06-05 23:28:41,420] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2019-06-05 23:28:41,487] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:28:41,487] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=connect-test,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=12,Replica=2],[Topic=__consumer_offsets,Partition=44,Replica=2],[Topic=__consumer_offsets,Partition=16,Replica=2],[Topic=__consumer_offsets,Partition=18,Replica=2],[Topic=__consumer_offsets,Partition=48,Replica=2],[Topic=__consumer_offsets,Partition=42,Replica=2],[Topic=__consumer_offsets,Partition=28,Replica=2],[Topic=__consumer_offsets,Partition=32,Replica=2],[Topic=__consumer_offsets,Partition=34,Replica=2],[Topic=__consumer_offsets,Partition=22,Replica=2],[Topic=__consumer_offsets,Partition=20,Replica=2],[Topic=__consumer_offsets,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=46,Replica=2],[Topic=__consumer_offsets,Partition=40,Replica=2],[Topic=my-replicated-topic,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=2,Replica=2],[Topic=__consumer_offsets,Partition=24,Replica=2],[Topic=__consumer_offsets,Partition=30,Replica=2],[Topic=__consumer_offsets,Partition=6,Replica=2],[Topic=__consumer_offsets,Partition=4,Replica=2],[Topic=__consumer_offsets,Partition=38,Replica=2],[Topic=__consumer_offsets,Partition=36,Replica=2],[Topic=__consumer_offsets,Partition=26,Replica=2],[Topic=__consumer_offsets,Partition=14,Replica=2],[Topic=__consumer_offsets,Partition=8,Replica=2],[Topic=__consumer_offsets,Partition=10,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=connect-test-0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-12) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-44) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-16) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-18) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-48) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,488] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-42) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-28) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-32) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-34) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-22) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-20) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-46) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-40) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=my-replicated-topic-0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-2) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-24) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-30) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-6) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-4) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-38) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-36) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-26) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-14) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-8) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,489] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-10) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:28:41,490] DEBUG [Controller id=0] Unregister BrokerModifications handler for ArrayBuffer(2) (kafka.controller.KafkaController)
[2019-06-05 23:31:52,936] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-06-05 23:31:52,936] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)), 1 -> Map(my-replicated-topic-0 -> Vector(1, 0, 2)), 0 -> Map(__consumer_offsets-21 -> Vector(0), __consumer_offsets-27 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-9 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-35 -> Vector(0), __consumer_offsets-41 -> Vector(0), __consumer_offsets-33 -> Vector(0), __consumer_offsets-23 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-47 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-3 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-15 -> Vector(0), __consumer_offsets-17 -> Vector(0), __consumer_offsets-19 -> Vector(0), __consumer_offsets-11 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-39 -> Vector(0), __consumer_offsets-45 -> Vector(0), __consumer_offsets-1 -> Vector(0), __consumer_offsets-5 -> Vector(0), __consumer_offsets-29 -> Vector(0))) (kafka.controller.KafkaController)
[2019-06-05 23:31:52,936] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)) (kafka.controller.KafkaController)
[2019-06-05 23:31:52,936] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2019-06-05 23:31:52,936] INFO [Controller id=0] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2019-06-05 23:31:52,937] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-06-05 23:31:52,937] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:31:52,937] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2019-06-05 23:31:52,937] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:36:52,937] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)), 1 -> Map(my-replicated-topic-0 -> Vector(1, 0, 2)), 0 -> Map(__consumer_offsets-21 -> Vector(0), __consumer_offsets-27 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-9 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-35 -> Vector(0), __consumer_offsets-41 -> Vector(0), __consumer_offsets-33 -> Vector(0), __consumer_offsets-23 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-47 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-3 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-15 -> Vector(0), __consumer_offsets-17 -> Vector(0), __consumer_offsets-19 -> Vector(0), __consumer_offsets-11 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-39 -> Vector(0), __consumer_offsets-45 -> Vector(0), __consumer_offsets-1 -> Vector(0), __consumer_offsets-5 -> Vector(0), __consumer_offsets-29 -> Vector(0))) (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(__consumer_offsets-22 -> Vector(2), __consumer_offsets-30 -> Vector(2), __consumer_offsets-8 -> Vector(2), __consumer_offsets-4 -> Vector(2), __consumer_offsets-46 -> Vector(2), __consumer_offsets-16 -> Vector(2), __consumer_offsets-28 -> Vector(2), __consumer_offsets-36 -> Vector(2), __consumer_offsets-42 -> Vector(2), connect-test-0 -> Vector(2), __consumer_offsets-18 -> Vector(2), __consumer_offsets-24 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-48 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-6 -> Vector(2), __consumer_offsets-14 -> Vector(2), __consumer_offsets-20 -> Vector(2), __consumer_offsets-0 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-12 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-34 -> Vector(2), __consumer_offsets-10 -> Vector(2), __consumer_offsets-32 -> Vector(2), __consumer_offsets-40 -> Vector(2)) (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] INFO [Controller id=0] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2019-06-05 23:36:52,938] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2019-06-05 23:37:11,058] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2019-06-05 23:37:11,058] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:11,073] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2019-06-05 23:37:11,074] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2019-06-05 23:37:11,084] INFO [RequestSendThread controllerId=0] Controller 0 connected to ubuntu:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-06-05 23:37:11,156] DEBUG [Controller id=0] Register BrokerModifications handler for ArrayBuffer(2) (kafka.controller.KafkaController)
[2019-06-05 23:37:13,363] DEBUG [Controller id=0] Sending MetadataRequest to Brokers: ArrayBuffer(0, 1, 2) for TopicPartitions: ArrayBuffer(my-replicated-topic-0) (kafka.controller.KafkaController)
[2019-06-05 23:37:45,528] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,528] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,528] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,529] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:45,529] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=my-replicated-topic,Partition=0,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:45,581] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:45,581] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=my-replicated-topic,Partition=0,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:45,582] TRACE [Controller id=0] All leaders = __consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),my-replicated-topic-0 -> (Leader:1,ISR:0,1,LeaderEpoch:4,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),connect-test-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2019-06-05 23:37:45,601] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,601] DEBUG [Controller id=0] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,601] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,627] TRACE [Controller id=0] All leaders = __consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),my-replicated-topic-0 -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),connect-test-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2019-06-05 23:37:45,643] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,643] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2019-06-05 23:37:45,643] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2019-06-05 23:37:45,650] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:45,664] TRACE [Controller id=0] All leaders = __consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),my-replicated-topic-0 -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),connect-test-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2019-06-05 23:37:45,753] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:45,854] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:45,955] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:46,057] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:46,158] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:46,171] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, all live brokers: 0,1 (kafka.controller.KafkaController)
[2019-06-05 23:37:46,172] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,172] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,172] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,172] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,174] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2019-06-05 23:37:46,174] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2019-06-05 23:37:46,271] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:46,275] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:46,275] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=connect-test,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=12,Replica=2],[Topic=__consumer_offsets,Partition=44,Replica=2],[Topic=__consumer_offsets,Partition=16,Replica=2],[Topic=__consumer_offsets,Partition=18,Replica=2],[Topic=__consumer_offsets,Partition=48,Replica=2],[Topic=__consumer_offsets,Partition=42,Replica=2],[Topic=__consumer_offsets,Partition=28,Replica=2],[Topic=__consumer_offsets,Partition=32,Replica=2],[Topic=__consumer_offsets,Partition=34,Replica=2],[Topic=__consumer_offsets,Partition=22,Replica=2],[Topic=__consumer_offsets,Partition=20,Replica=2],[Topic=__consumer_offsets,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=46,Replica=2],[Topic=__consumer_offsets,Partition=40,Replica=2],[Topic=my-replicated-topic,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=2,Replica=2],[Topic=__consumer_offsets,Partition=24,Replica=2],[Topic=__consumer_offsets,Partition=30,Replica=2],[Topic=__consumer_offsets,Partition=6,Replica=2],[Topic=__consumer_offsets,Partition=4,Replica=2],[Topic=__consumer_offsets,Partition=38,Replica=2],[Topic=__consumer_offsets,Partition=36,Replica=2],[Topic=__consumer_offsets,Partition=26,Replica=2],[Topic=__consumer_offsets,Partition=14,Replica=2],[Topic=__consumer_offsets,Partition=8,Replica=2],[Topic=__consumer_offsets,Partition=10,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=connect-test-0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-12) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-44) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-16) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-18) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-48) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-42) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-28) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-32) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-34) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-22) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-20) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-46) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-40) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,275] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=my-replicated-topic-0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-2) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-24) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-30) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-6) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-4) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-38) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-36) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-26) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-14) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-8) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=__consumer_offsets-10) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,276] DEBUG [Controller id=0] Unregister BrokerModifications handler for ArrayBuffer(2) (kafka.controller.KafkaController)
[2019-06-05 23:37:46,373] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker ubuntu:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to ubuntu:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:279)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2019-06-05 23:37:46,400] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, all live brokers: 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:46,401] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,401] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,401] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,402] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2019-06-05 23:37:46,405] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2019-06-05 23:37:46,405] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2019-06-05 23:37:46,452] WARN [Channel manager on controller 0]: Not sending request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=1, partitionStates={my-replicated-topic-0=PartitionState(controllerEpoch=1, leader=0, leaderEpoch=5, isr=0, zkVersion=7, replicas=1,0,2, isNew=false)}, liveLeaders=(ubuntu:9092 (id: 0 rack: null))) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,453] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:46,453] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=my-replicated-topic,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2019-06-05 23:37:46,453] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=) to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,453] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, deletePartitions=false, partitions=my-replicated-topic-0) to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-06-05 23:37:46,453] DEBUG [Controller id=0] Unregister BrokerModifications handler for ArrayBuffer(1) (kafka.controller.KafkaController)
[2019-06-05 23:37:50,678] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:50,678] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:50,678] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2019-06-05 23:37:50,680] TRACE [Controller id=0] All leaders = __consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),my-replicated-topic-0 -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),connect-test-0 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2019-06-05 23:37:55,684] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:55,684] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2019-06-05 23:37:55,684] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2019-06-05 23:37:55,685] TRACE [Controller id=0] All leaders = __consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),my-replicated-topic-0 -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),connect-test-0 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:-1,ISR:2,LeaderEpoch:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2019-06-05 23:38:01,280] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-06-05 23:38:01,280] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-06-05 23:38:01,280] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-06-05 23:38:01,281] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2019-06-05 23:38:01,281] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2019-06-05 23:38:01,282] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2019-06-05 23:38:01,283] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2019-06-05 23:38:01,283] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2019-06-05 23:38:01,283] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2019-06-05 23:38:01,283] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2019-06-05 23:38:01,287] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
